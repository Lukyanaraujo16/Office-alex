$(function(){function e(e){bootbox.dialog({message:'<p class="text-center mb-0"><i class="fa fa-spin fa-cog"></i> Carregando...</p>',closeButton:!1}),$.post("/sys/api.php?action=fast_message&type=iptv&client_id="+e,function(e){if(bootbox.hideAll(),$(".bootbox.modal").remove(),$(".modal-backdrop").remove(),"success"==e.result){const t='<div class="fast-message">'+e.message.replace(/(?:\r\n|\r|\n)/g,"<br>")+'</div><button type="button" class="btn copy-fast-message d-none" data-clipboard-target=".fast-message">Hide Button ;)</button>';bootbox.dialog({message:t,buttons:{noclose2:{label:"Whatsapp",className:"btn-success waves-effect waves-light",callback:function(){const t=encodeURIComponent(e.message.replace(/<br\s*[\/]?>/gi,"")),a="https://api.whatsapp.com/send?phone=&text="+t,o=window.open(a,"_blank");return o?o.focus():window.location.href=a,!1}},noclose:{label:"Copiar",className:"btn-primary bg-gradient waves-effect waves-light",callback:function(){return $(".copy-fast-message").click(),!1}},cancel:{label:"Fechar",className:"btn-secondary waves-effect waves-light",callback:function(){}}}}),new ClipboardJS(".copy-fast-message")}},"JSON")}toastr.options={closeButton:!1,debug:!1,newestOnTop:!0,progressBar:!0,positionClass:"toast-top-right",preventDuplicates:!1,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"};var t=$("#table").DataTable({ajax:"/sys/api.php?action=get_clients",processing:!0,serverSide:!0,columns:[{data:"id"},{data:"display_username"},{data:"password"},{data:"email"},{data:"created_at"},{data:"exp_date"},{data:"reseller_name"},{data:"max_connections"},{data:"reseller_notes"},{data:"status"},{data:"action"}],columnDefs:[{targets:[0,1,2,3,4,5,6,7,8,9,10],className:"text-center"}],order:[[0,"desc"]],paging:!0,lengthChange:!0,searching:!0,ordering:!0,orderMulti:!1,info:!0,autoWidth:!1,language:{processing:"Processando...",lengthMenu:"Mostrar _MENU_ registros",zeroRecords:"N√£o foram encontrados resultados",info:"Mostrando de _START_ at√© _END_ de _TOTAL_ registros",infoEmpty:"Mostrando de 0 at√© 0 de 0 registros",sInfoFiltered:"",sInfoPostFix:"",search:"Buscar:",url:"",loadingRecords:"Carregando...",paginate:{first:"Primeiro",previous:"<i class='fas fa-chevron-left'></i>",next:"<i class='fas fa-chevron-right'></i>",last:"√öltimo"}},drawCallback:function(){$('[data-toggle="tooltip"]').tooltip()}});$(document).on("click",".btrefresh",function(e){t.ajax.reload(),toastr.info("Recarregando tabela")}),$(document).on("click",".bttela",function(e){e.preventDefault();const a=$(this).data("id");bootbox.dialog({title:"Tem certeza que deseja adicionar mais uma tela ?",message:"<p>"+$(this).data("text")+"</p>",buttons:{cancel:{label:"Cancelar",className:"btn-secondary",callback:function(){}},noclose:{label:"Confirmar",className:"btn-info btnaddscreen",callback:function(){$(".btnaddscreen").hide(),$.get("/sys/api.php?action=add_screen&client_id="+a,function(e){"success"===e.result?(t.ajax.reload(),toastr.success("M√°ximo de conex√µes aumentada com sucesso!")):toastr.warning("N√£o foi poss√≠vel aumentar o m√°ximo de conex√µes do cliente.")},"json")}}}})}),$(document).on("click",".btfastmessage",function(t){t.preventDefault();const a=$(this).data("id");e(a)}),$(document).on("click",".btrenewplus",function(e){e.preventDefault();const a=$(this).data("id");bootbox.dialog({title:"Tem certeza que deseja renovar este cliente ?",message:"<p>"+$(this).data("text")+'</p><form class="form-horizontal"><div class="form-group col-md-6"><label class="form-control-label">Quantidade de meses</label><div class="input-group"><span class="input-group-addon"><i class="fa fa-calendar-plus-o"></i></span><input type="number" class="form-control" required="" value="1" autocomplete="off" id="months" name="months"></div></div><div class="form-group row"><div class="col-md-12"><span class="text-white">Escolha a quantidade de meses.<br><br><b>Fique atento, caso seja um usuario de 2 telas ir√° cobrar o dobro de cr√©ditos equivalente a quantidade de meses.</b></span></div></div></form>',buttons:{cancel:{label:"Cancelar",className:"btn-secondary",callback:function(){}},noclose:{label:"Confirmar",className:"btn-info btnrenewplus",callback:function(){$(".btnrenewplus").hide();const e=$("#months").val();e>0?$.get("/sys/api.php?action=renew_client_plus&client_id="+a+"&months="+e,function(e){"success"===e.result?(t.ajax.reload(),toastr.success("Cliente renovado com sucesso!")):toastr.warning("N√£o foi poss√≠vel renovar o cliente.")},"json"):toastr.warning("Quantidade de meses inv√°lida.")}}}})}),$(document).on("click",".btblock",function(e){e.preventDefault();const a=$(this).data("id");bootbox.dialog({title:"Tem certeza que deseja bloquear/desbloquear este usu√°rio ?",message:"<p>"+$(this).data("text")+"</p>",buttons:{cancel:{label:"Cancelar",className:"btn-secondary",callback:function(){}},noclose:{label:"Confirmar",className:"btn-warning btnblock",callback:function(){$(".btnblock").hide(),$.get("/sys/api.php?action=toggle_block_client&user_id="+a,function(e){"success"===e.result?(t.ajax.reload(),toastr.success("Usu√°rio bloqueado/desbloqueado com sucesso!")):toastr.warning("N√£o foi poss√≠vel bloquear/desbloquear este usu√°rio.")},"json")}}}})}),$(document).on("click",".btdelete",function(e){e.preventDefault();const a=$(this).data("id");bootbox.dialog({title:"Tem certeza que deseja deletar este usu√°rio ?",message:"<p>"+$(this).data("text")+"</p>",buttons:{cancel:{label:"Cancelar",className:"btn-secondary",callback:function(){}},noclose:{label:"Confirmar",className:"btn-danger btndelete",callback:function(){$(".btndelete").hide(),$.get("/sys/api.php?action=delete_client&user_id="+a,function(e){"success"===e.result?(t.ajax.reload(),toastr.success("Usu√°rio deletado com sucesso!")):toastr.warning("N√£o foi poss√≠vel deletar este usu√°rio.")},"json")}}}})}),$(document).on("click",".btconvert",function(e){e.preventDefault();const a=$(this).data("id");bootbox.hideAll(),bootbox.dialog({title:"Tem certeza que deseja converter para P2P?",message:"<p>"+$(this).data("text")+"</p>",buttons:{cancel:{label:"Cancelar",className:"btn-secondary waves-effect waves-light",callback:function(){}},noclose:{label:"Confirmar",className:"btn-primary bg-gradient waves-effect waves-light btnconvert",callback:function(){$(".btnconvert").hide(),bootbox.dialog({message:'<p class="text-center mb-0"><i class="fas fa-spinner fa-spin"></i> Carregando... Por favor aguarde.</p>',closeButton:!1}),$.get("/sys/api.php?action=convert&user_id="+a+"&from=iptv",function(e){"success"===e.result?(t.ajax.reload(),toastr.success("IPTV convertido para P2P com sucesso!")):!1===e.result?toastr.warning(e.message):toastr.warning("N√£o foi poss√≠vel converter este usu√°rio."),bootbox.hideAll()},"json")}}}})});const a="<?php echo getServerDNS(); ?>",o="<?php echo OFFICE_CONFIG['shorten_url']; ?>",s="<?php echo OFFICE_CONFIG['ssiptv_url']; ?>",n="<?php echo $logged_user['id']; ?>",l=a.split("//"),c="<option value='"+a+"'>"+l[1]+"</option>\n\r",i="<option value='type=m3u_plus&output=ts'>M3U Plus</option>\n\r<option value='type=m3u&output=ts'>M3U</option>\n\r<option value='type=m3u_plus&output=hls'>HLS Plus</option>\n\r<option value='type=m3u&output=hls'>HLS</option>\n\r<option value='SSIPTV'>SSIPTV üì∫</option>\n\r",r="<option value='"+s+"/ssiptv/'>Link SSIPTV</option>\n\r";$(document).on("click",".btlink",function(e){function t(){if("SSIPTV"!=$("#c_type").val()){""!=d&&"SSIPTV"!=d||$("#c_dns").html(c),""==d&&($("#c_dns").html(c),$("#c_type").html(i));const e=$("#c_dns").val()+"/get.php?username="+a+"&password="+s+"&"+$("#c_type").val();$("#list_link").val(e)}else{$("#c_dns").html(r);const e=$("#c_dns").val()+"get/"+a+"/"+s+"/download_m3u/";$("#list_link").val(e)}$(".btshorten").show(),d=$("#c_type").val()}e.preventDefault();const a=$(this).data("user"),s=$(this).data("pass");var l=bootbox.dialog({size:"large",title:"Gerar Link",message:'<form id="download_list" class="form-horizontal"> <div class="form-group row"> <div class="col-md-8"> <label class="form-control-label">Escolha o DNS:</label> <div class="input-group"> <select class="form-control" required="" autocomplete="off" id="c_dns"> </select> </div> </div> <div class="col-md-4"> <label class="form-control-label">Tipo:</label> <div class="input-group"> <select class="form-control" required="" autocomplete="off" id="c_type"> </select> </div> </div> </div> <div class="form-group mt-3 row"> <div class="col-md-12"> <label class="form-control-label">Seu link:</label> <div class="input-group"> <input type="text" class="form-control" required="" autocomplete="off" id="list_link" readonly> <div class="input-group-append"> <button type="button" class="btn btn-sm btn-primary bg-gradient waves-effect waves-light copylinklist" data-clipboard-target="#list_link">COPIAR</button> </div> </div> </div> </div> </form>',buttons:{noclose:{label:"Encurtar",className:"btn-success bg-gradient waves-effect waves-light btshorten",callback:function(){return $(".btshorten").hide(),$.get(o,{url:$("#list_link").val(),creator_id:n,format:"text"},function(e){$("#list_link").val(e)}),!1}},cancel:{label:"Fechar",className:"btn-secondary waves-effect waves-light",callback:function(){}}}});l.init(function(){$("#c_dns").html(c),$("#c_type").html(i),t(),new ClipboardJS(".copylinklist")}),$("body").on("change","select",function(){t()});var d=""});const d=new URLSearchParams(window.location.search),u=d.get("client_id");u&&""!=u?e(u):"show"==window.location.pathname.split("/")[3]&&""!=window.location.pathname.split("/")[4]&&e(window.location.pathname.split("/")[4])});
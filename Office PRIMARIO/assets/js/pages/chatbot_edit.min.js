$(function(){$(".select2bs4").select2({theme:"bootstrap4"})}),$(document).ready(function(){function e(e){var t=document.getElementById("response"),a=document.getElementById("server_template_"+e).value;t.value=a,t.focus()}$(".addmessage").click(function(){var e=$("#message").val();if(""!=$("#message").val()){var t=$("<tr><td>"+e+'</td><td><button type="button" class="btn btn-outline-danger btn-sm float-right"><i class="far fa-times danger"></i></button></td></tr>');$("table tbody").append(t),$("#message").val(""),$("#message").removeClass("is-invalid")}else $("#message").addClass("is-invalid")}),$("table").on("click",".btn-outline-danger",function(){$(this).closest("tr").remove()}),$("#rule_type").on("change",function(){""!=$(this).val()&&$(this).removeClass("is-invalid")}),$("#rule_action").on("change",function(){""!=$(this).val()&&$(this).removeClass("is-invalid");var t=$(this).val(),a=t.split("_");"iptv"==a[1]?e("iptv"):"code"==a[1]?e("code"):"binstream"==a[1]&&e("binstream")}),$("#response").on("change",function(){""!=$(this).val()&&$(this).removeClass("is-invalid")}),$(".editrule").on("click",function(){$(".editrule").attr("disabled",!0);var e=[];$("table.table tbody tr").each(function(){var t=$(this).find("td:first-child").text();e.push(t)});var t=$("#rule_type").val(),a=$("#rule_action").val(),s=$("#response").val(),i=$("#rule_id").val(),n=!0;if($(".required-input").each(function(){""==$(this).val()?($(this).addClass("is-invalid"),n=!1):$(this).removeClass("is-invalid")}),e.length<=0&&($("#message").addClass("is-invalid"),n=!1),n){var l={action:"edit_chatbot_rule",rule_type:t,rule_action:a,response:s,messages:e,rule_id:i};$.ajax({url:"/sys/api.php",type:"POST",data:l,success:function(e){0==e.success?Swal.fire("Ops...",e.message,"warning"):(Swal.fire({title:"Regra salva!",html:"Voltando a lista de regras...",icon:"success",timer:5e3,timerProgressBar:!0}),setTimeout(function(){window.location.href="/chatbot/list"},5e3))},error:function(e,t,a){Swal.fire("Ops!","Ocorreu um erro ao editar a regra","error")}})}})});
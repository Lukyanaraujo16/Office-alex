$(function(){$(".select2bs4").select2({theme:"bootstrap4"})}),$(document).ready(function(){function e(e){var a=document.getElementById("response"),t=document.getElementById("server_template_"+e).value;a.value=t,a.focus()}$(".addmessage").click(function(){var e=$("#message").val();if(""!=$("#message").val()){var a=$("<tr><td>"+e+'</td><td><button type="button" class="btn btn-outline-danger btn-sm float-right"><i class="far fa-times danger"></i></button></td></tr>');$("table tbody").append(a),$("#message").val(""),$("#message").removeClass("is-invalid")}else $("#message").addClass("is-invalid")}),$("table").on("click",".btn-outline-danger",function(){$(this).closest("tr").remove()}),$("#rule_type").on("change",function(){""!=$(this).val()&&$(this).removeClass("is-invalid")}),$("#rule_action").on("change",function(){""!=$(this).val()&&$(this).removeClass("is-invalid");var a=$(this).val(),t=a.split("_");"iptv"==t[1]?e("iptv"):"code"==t[1]?e("code"):"binstream"==t[1]&&e("binstream")}),$("#response").on("change",function(){""!=$(this).val()&&$(this).removeClass("is-invalid")}),$(".addrule").on("click",function(){if(!$(".addrule").attr("disabled")){$(".addrule").attr("disabled",!0);var e=[];$("table.table tbody tr").each(function(){var a=$(this).find("td:first-child").text();e.push(a)});var a=$("#rule_type").val(),t=$("#rule_action").val(),s=$("#response").val(),i=!0;if($(".required-input").each(function(){""==$(this).val()?($(this).addClass("is-invalid"),i=!1):$(this).removeClass("is-invalid"),$(".addrule").attr("disabled",!1)}),e.length<=0&&($("#message").addClass("is-invalid"),i=!1,$(".addrule").attr("disabled",!1)),i){var r={action:"add_chatbot_rule",rule_type:a,rule_action:t,response:s,messages:e};$.ajax({url:"/sys/api.php",type:"POST",data:r,success:function(e){0==e.success?Swal.fire("Ops...",e.message,"warning"):(Swal.fire({title:"Regra Criada!",html:"Fique a vontade para criar novas regras...",icon:"success",timer:5e3,timerProgressBar:!0}),$(".addrule").attr("disabled",!1),$("#rule_type").val(""),$("#rule_action").val(""),$("#response").val(""),$("table.table tbody tr").remove())},error:function(e,a,t){Swal.fire("Ops!","Ocorreu um erro ao criar a regra","error"),$(".addrule").attr("disabled",!1)}})}}})});